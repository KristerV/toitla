'use strict';

var _expect = require('expect');

var _expect2 = _interopRequireDefault(_expect);

var _expectJsx = require('expect-jsx');

var _expectJsx2 = _interopRequireDefault(_expectJsx);

var _skinDeep = require('skin-deep');

var _skinDeep2 = _interopRequireDefault(_skinDeep);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _index = require('./index.js');

var _index2 = _interopRequireDefault(_index);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_expect2.default.extend(_expectJsx2.default); /* global describe it beforeEach */

var src = 'http://domain.imgix.net/image.jpg';
var tree = undefined,
    vdom = undefined,
    instance = undefined; // eslint-disable-line no-unused-vars

describe('<img> mode', function () {
  beforeEach(function () {
    tree = _skinDeep2.default.shallowRender(_react2.default.createElement(_index2.default, {
      src: src,
      aggresiveLoad: true
    }));
    vdom = tree.getRenderOutput();
    instance = tree.getMountedInstance();
  });

  it('should render an image', function () {
    (0, _expect2.default)(vdom.type).toBe('img');
  });
  it('should have a src tag', function () {
    (0, _expect2.default)(vdom.props.src).toInclude(src);
  });
});
describe('background mode', function () {
  beforeEach(function () {
    tree = _skinDeep2.default.shallowRender(_react2.default.createElement(_index2.default, {
      src: src,
      bg: true,
      aggresiveLoad: true
    }));
    vdom = tree.getRenderOutput();
    instance = tree.getMountedInstance();
  });
  it('should render a div', function () {
    (0, _expect2.default)(vdom.type).toBe('div');
  });
  it('should have the appropriate styles', function () {
    (0, _expect2.default)(vdom.props.style.backgroundImage).toInclude(src);
    (0, _expect2.default)(vdom.props.style.backgroundSize).toBe('cover');
  });
});
describe('custom component', function () {
  beforeEach(function () {
    tree = _skinDeep2.default.shallowRender(_react2.default.createElement(_index2.default, {
      src: src,
      component: 'li',
      bg: true,
      aggresiveLoad: true
    }));
    vdom = tree.getRenderOutput();
    instance = tree.getMountedInstance();
  });
  it('should render the custom component', function () {
    (0, _expect2.default)(vdom.props.style.backgroundImage).toInclude(src);
    (0, _expect2.default)(vdom.type).toBe('li');
  });
});
describe('image props', function () {
  var className = 'img--enabled';
  beforeEach(function () {
    tree = _skinDeep2.default.shallowRender(_react2.default.createElement(_index2.default, {
      src: src,
      auto: ['format', 'enhance'],
      className: className,
      aggresiveLoad: true,
      faces: true
    }));
    vdom = tree.getRenderOutput();
    instance = tree.getMountedInstance();
  });
  it('auto prop', function () {
    (0, _expect2.default)(vdom.props.src).toInclude('auto=format%2Cenhance');
  });
  it('className prop', function () {
    (0, _expect2.default)(vdom.props.className).toInclude(className);
  });
  it('faces prop', function () {
    (0, _expect2.default)(vdom.props.src).toInclude('crop=faces');
  });
  it('fit prop', function () {
    (0, _expect2.default)(vdom.props.src).toInclude('fit=crop');
  });
  it('entropy prop', function () {
    tree = _skinDeep2.default.shallowRender(_react2.default.createElement(_index2.default, {
      src: src,
      aggresiveLoad: true,
      entropy: true
    }));
    vdom = tree.getRenderOutput();

    (0, _expect2.default)(vdom.props.src).toInclude('crop=entropy');
    (0, _expect2.default)(vdom.props.src).toInclude('fit=crop');
  });
  // it('fluid prop', () => {
  //   expect(vdom.props.src).to.include('auto=format,enhance')
  // })
  // it('precision prop', () => {
  //   expect(vdom.props.src).to.include('auto=format,enhance')
  // })
  // it.skip('custom props', () => {
  //   expect(vdom.props.src).to.include('auto=format,enhance')
  // })
  it('generateSrcSet prop', function () {
    tree = _skinDeep2.default.shallowRender(_react2.default.createElement(_index2.default, {
      src: src,
      aggresiveLoad: true,
      generateSrcSet: true
    }));
    vdom = tree.getRenderOutput();

    (0, _expect2.default)(vdom.props.srcSet).toInclude('dpr=2');
    (0, _expect2.default)(vdom.props.srcSet).toInclude('dpr=3');
  });
});